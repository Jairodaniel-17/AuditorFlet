"\"\"Results dashboard view implemented with Tkinter.\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nfrom pathlib import Path\nimport tkinter as tk\nfrom tkinter import ttk\n\n\ndef build(parent: tk.Widget, context) -> ttk.Frame:\n    frame = ttk.Frame(parent, padding=20)\n    ttk.Label(frame, text=\"Results\", font=(\"Segoe UI\", 18, \"bold\")).pack(anchor=\"w\")\n\n    job = _latest_completed_job(context)\n    if not job:\n        ttk.Label(frame, text=\"Ejecuta un an√°lisis para ver resultados.\").pack(anchor=\"w\", pady=20)\n        return frame\n\n    docs_path = Path(job.results.get(\"docs_path\", \"\"))\n    index_path = docs_path / \"index.json\"\n    summary = {}\n    if index_path.exists():\n        summary = json.loads(index_path.read_text(encoding=\"utf-8\"))\n\n    counts = summary.get(\"counts\", {})\n    ttk.Label(frame, text=f\"Overall Score: {summary.get('summary_scores', {}).get('overall', 0):.1f}\").pack(anchor=\"w\")\n    ttk.Label(frame, text=f\"Files analyzed: {counts.get('files', 0)}\").pack(anchor=\"w\")\n    ttk.Label(frame, text=f\"High severity hotspots: {counts.get('hotspots_high', 0)}\").pack(anchor=\"w\")\n\n    ttk.Label(frame, text=\"Ranking de archivos\", font=(\"Segoe UI\", 12, \"bold\")).pack(anchor=\"w\", pady=(15, 5))\n    columns = (\"path\", \"score\", \"hotspots\")\n    tree = ttk.Treeview(frame, columns=columns, show=\"headings\", height=10)\n    for col in columns:\n        tree.heading(col, text=col.title())\n        tree.column(col, width=220 if col == \"path\" else 120)\n    tree.pack(fill=\"both\", expand=True)\n\n    for record in summary.get(\"ranking_files\", [])[:10]:\n        tree.insert(\"\", tk.END, values=(record[\"path\"], f\"{record['score_overall']:.1f}\", record[\"hotspots_high\"]))\n\n    ttk.Label(frame, text=\"Top 10 Hotspots\", font=(\"Segoe UI\", 12, \"bold\")).pack(anchor=\"w\", pady=(15, 5))\n    hotspot_list = tk.Text(frame, height=8)\n    hotspot_list.pack(fill=\"both\", expand=True)\n    for hotspot in summary.get(\"top_hotspots\", []):\n        hotspot_list.insert(\n            \"end\",\n            f\"- {hotspot.get('severity')} :: {hotspot.get('file')} :: {hotspot.get('title')} ({hotspot.get('line_range')})\\n\",\n        )\n    if not summary.get(\"top_hotspots\"):\n        hotspot_list.insert(\"end\", \"No hay hotspots registrados.\")\n    hotspot_list.configure(state=\"disabled\")\n    return frame\n\n\ndef _latest_completed_job(context):\n    jobs = [job for job in context.job_queue.list_jobs() if job.status.name == \"COMPLETED\"]\n    return jobs[-1] if jobs else None\n*** End Patch" }"""
